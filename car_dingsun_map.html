<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf8"/>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <link rel="stylesheet" href="css/my_style.css">
    <script src="js/jquery-1.11.1.min.js"></script>
    <title>车辆定损网点</title>
    <style type="text/css">
        body, html {
            width: 100%;
            height: 100%;
            margin: 0;
            font-family: "微软雅黑";
        }

        #l-map {
            height: 100%;
            width: 100%;
        }

        #r-result {
            width: 100%;
            font-size: 14px;
            line-height: 20px;
        }
    </style>
    <script type="text/javascript"
            src="http://api.map.baidu.com/api?v=2.0&ak=5H1cYMzqXRSKUE6WraRM7pxAb9qe5MnN"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/SearchInfoWindow/1.5/src/SearchInfoWindow_min.js"></script>
    <link rel="stylesheet" href="http://api.map.baidu.com/library/SearchInfoWindow/1.5/src/SearchInfoWindow_min.css"/>
</head>
<body>
<div id="l-map"></div>
<div id="r-result">
    <div style="position:absolute; margin-top: 20px; margin-left: 20px; left:0; top: 0;">
        <input id="keyword" placeholder="请输入地址">
        <input id="search_btn" class="key_search" type="button" value="搜索" onclick="search_click()">
    </div>

    <div id="result" style="position:absolute;z-index: 2"></div>
</div>
</body>
</html>
<script type="text/javascript">
    // 百度地图API功能
    var map = new BMap.Map("l-map");
    map.centerAndZoom(new BMap.Point(116.797107,37.636986), 5);
    map.enableScrollWheelZoom(true);
    var index = 0;
    var myGeo = new BMap.Geocoder();
    // 定损网点地址
    var adds = [
        "江西省萍乡市安源区长兴馆建设路9号",
        "安徽省蚌埠市长征路125号",
        "安徽省蚌埠市经开区兴业街792号三星集团楼下",
        "河南省新乡市封丘县南封曹路838",
        "安徽省淮南市泉山西路旺泉公学西300米路南",
        "安徽省蚌埠市淮上区蚌固路",
        "河北省保定市朝阳北大街1233号",
        "安徽省合肥市徽州大道1186号",
        "山东省济南市历城区王舍人街道祥泰城西北400米",
        "亳州市工业园区淮河路南侧",
        "山东省潍坊市昌邑市二零六国道与南苑西街交汇处昌邑大转盘东南角",
        "山东省临沂市郯城县郯东路190号",
        "山东省滨州市黄河5号渤海11路",
        "山东省济宁市鱼台县北环路济宁市申科汽车销售服务有限公司鱼台分公司北97米",
        "云南省楚雄市鹿城镇东兴社区小姑英二村",
        "河北省廊坊市大城县平舒镇滨河街红木书画扇艺术馆附近",
        "黑龙江省大兴安岭地区塔河县207",
        "山东省德州市德城区大学东路1527号艾家坊小区东243米",
        "内蒙古自治区锡林郭勒盟多伦县广诚汽车服务有限公司",
        "云南文山壮族苗族自治州广南县文山汽配城",
        "贵州省贵阳市南明区青云路302号",
        "辽宁省海城市南外环",
        "河北省邯郸市拖拉机厂西北60米",
        "吉林省吉林市昌邑区辽宁路",
        "河北省邢台市巨鹿县巨鹿镇东杨庄村西",
        "河北省张家口市西门村康定路",
        "黑龙江省绥化市兰西县东环城路老电池厂对面",
        "黑龙江省齐齐哈尔市讷河市新客运站西厢房北走300米",
        "河北省邢台市开发区建业路大梁庄商贸楼北侧",
        "河北省石家庄市平山县柏坡东路",
        "山东省青岛市平度市青啤大道30—1号",
        "河北省邯郸市邯郸县高新技术产业园区内（东环路与309国道交叉口东行200米路北",
        "山东省日照市东港区日照路北首",
        "辽宁省东港市环城西大街100号",
        "山东省临沂市平邑县327国道与文化路交汇处东南角",
        "新疆维吾尔自治区巴音郭楞蒙古自治州若羌县315国道1560公里处",
        "广东省肇庆市端州二路",
        "江苏省苏州市太仓市太仓经济开发区板桥兴业路199号",
        "深圳市宝安区沙井新桥107国道东侧兴业丰田店（沙井客运站往松岗2Km）",
        "内蒙古自治区呼和浩特市新城区海东路",
        "山东省泰安市宁阳县城北关路105号",
        "湖北省天门市西寺",
        "河南省开封市尉氏县人民路东段路南",
        "河北省邯郸市邯郸县高新技术产业园区内（东环路与309国道交叉口东行200米路北",
        "内蒙古自治区乌海市巴青赛黄磷厂西侧",
        "内蒙古自治区乌海市海勃湾区海达街30号",
        "湖北省咸宁市温泉咸宁大道泉塘六组菜市场",
        "湖北省咸宁市赤壁市赤马港周画路幸福大道",
        "湖北省孝感市汉川市汉川经济开发区荷沙路以北",
        "湖南省邵阳市双清区长岭社区晏家渔塘2组42号",
        "河南省新乡市红旗区文化路南段西院旁边",
        "河南省南阳市新野县城东新唐路看守所斜对面",
        "陕西省咸阳市兴平市西城区金城路西段南侧南汤台",
        "安徽省宿州市道东大街235号",
        "江苏省徐州市二环北路下淀路",
        "湖南省怀化市溆浦县溆浦城南雷达站往前300米",
        "山东省烟台市芝罘区机场路卧龙工业园",
        "湖北省宜昌市伍家岗",
        "河北省廊坊市永清镇南关厢",
        "湖南省郴州市永兴县黄泥镇灵坎桥",
        "湖南省株洲市攸县交通北路170号",
        "山东省聊城市莘县莘聊路（新汽车站北500米路东）",
        "山西省运城市河东东街268号",
        "湖南省张家界市桑植县澧源镇文明路（五里桥变电站内）",
        // "河北省张家口市张家口桥西区高家屯",
        "河北省石家庄市正定县车站西街交通宾馆路西综合楼",
        "重庆市忠县忠州镇瑜巴路新桥三社",
        "山东省淄博市张恒路11号",
        "贵州省黔南布依族苗族自治州都匀市剑江北路55号",
        "河北省邢台市隆尧县山口镇北潘庄",
        "山东省日照市岚山区安东卫街道",
        "湖北省咸宁市温泉咸宁大道泉塘六组菜市场",
        "山东省栖霞市迎宾路",
        "河北省沧州市献县东环南路32号",
        "湖南省株洲市茶陵县炎黄南路1号",
        "云南省楚雄州元谋县马元镇",
        "山东省临沂市兰陵县兰陵路东段",
        "河北省石家庄市深泽县府前西街285号",
        "湖南省邵阳市大祥区祭旗坡376号",
        "湖北省天门市西寺",
        "湖南省郴州市宜章县岩泉镇红桥"
    ];
    // 定损网店名称和电话
    var repairs = [
        "萍乡市旅汽汽车维修有限公司	0799-6225779",
        "蚌埠市盛通汽车修理厂	0552-4082777",
        "平安直赔中心	0552-3096212",
        "大众汽车修理厂	0373-8566999",
        "淮南市赤骥汽车销售服务公司	18655476810",
        "陈庆修理厂	0552-2818251",
        "平安直赔中心	0312-336988",
        "安徽省直机关汽车修理厂	0551-63421966",
        "鲍德汽修	15253163135",
        "亳州兄弟汽车销售服务有限公司	15256152637",
        "昌邑广潍金达	18660656865",
        "郯城远通汽车销售公司	13287177999",
        "平安直赔中心	0543-2296341",
        "鱼台车源汽修厂	13639427959",
        "佳驰汽车修理厂	13576723899",
        "宏源汽车修理厂	0316-5592837",
        "塔河县福新机械修理厂	0457-3661346",
        "德州新一汽车贸易有限公司	13853485928",
        "广诚汽车服务有限公司	13610720712",
        "广南万胜汽车修理厂	13887645311",
        "贵州广电致远修理厂	13885088449",
        "亨通汽车修理厂	0412-3308707",
        "邯郸郸嘉汽车修理厂	13730015646",
        "昌邑大禹快保修理厂	15043260111",
        "鹏裕汽车修理厂	13930932003",
        "众奥汽车贸易有限公司	13960215771",
        "兰西县鑫之盛汽车修配厂	18745595799",
        "讷河市众捷汽车修配厂	13136630111",
        "邢台市华信汽车商贸有限公司	13153732611",
        "平山支公司平安定损中心	0311-89112269",
        "青岛万泉山汽车销售有限公司	13661256984",
        "邯郸市广星汽车销售服务有限公司	13916954862",
        "日照易通集团	18663330271",
        "东港市宏泰汽车修理厂	13190242555",
        "平邑远通汽车销售服务有限公司	13455940910",
        "若羌金驰汽车修理厂	17797971119",
        "肇庆市星湖汽车维修有限公司	13623211615",
        "太仓市板桥汽车修理有限公司	15942365612",
        "沙井兴业丰田平安直赔中心	13464687979",
        "呼市新城区君安汽车公司	12585647596",
        "宁阳县桑迪汽车维修中心	15689235648",
        "益华汽车修理厂	0728-5234921",
        "尉氏县安捷汽车维修服务有限公司	13837855799",
        "邯郸市广星汽车销售服务有限公司	13785692136",
        "乌达汽车修理厂	0473-3023634",
        "乌海市宏兴汽车销售有限责任公司	13836524965",
        "温泉冠捷汽车服务中心	13592568415",
        "赤壁市运通汽车生活馆	18722659831",
        "汉川贤良汽车销售服务有限公司	15564879852",
        "邵阳市昌和汽车服务有限公司	18711552662",
        "新乡市红旗区通达汽车维修中心	13069397778",
        "新野鑫源众兴汽车商贸有限公司	13525676929",
        "陕西兴平启运汽车销售有限公司	13991967586",
        "鑫达汽车修理厂	13687648328",
        "徐州鼓楼区金钊汽车修理厂	18068728866",
        "溆浦驰风进口汽车修理厂	0745-3223777",
        "烟台永军汽车维修服务有限公司	0535-6023828",
        "宜昌中华汽车修理厂	13310560615",
        "立新汽车修理厂	1374983944",
        "永兴县郴永汽修厂	13187369445",
        "攸县银河汽车修理厂	15886355533",
        "山东莘县华兴汽车销售有限公司	13881560269",
        "运城支公司	1357681862",
        "桑植天合汽车修理厂	15274406000",
        // "张家口市通盛汽修厂	15930988777",
        "正定鑫辉汽修厂	13582010665",
        "忠县翔驰汽车维修有限公司	13101087488",
        "淄博大华汽修厂	1369349820",
        "黔南金星汽车修理厂	0851-4926919",
        "隆尧永佳汽车维修公司	0319-7183367",
        "岚山区岚鑫汽修厂	13606333617",
        "温泉冠捷汽车服务中心	13592568415",
        "栖霞市振华汽修厂	5211497",
        "献县汽车修理厂	4623588",
        "茶陵顺达汽修厂	0731-25211555",
        "元谋精诚汽修公司	13987844778",
        "兰陵县路路顺汽修厂	15653989915",
        "深泽县宏伟汽修厂	83525468",
        "邵阳锦程汽修厂	13975989371",
        "益华汽车修理厂	0728-5234921",
        "宜章南华汽修厂	13549516620"
    ];
    // 关键字匹配成功计数
    var count = 0;
    var keyword = "";

    document.onkeyup = function (e) {//按键信息对象以函数参数的形式传递进来了，就是那个e
        var code = e.charCode || e.keyCode;  //取出按键信息中的按键代码(大部分浏览器通过keyCode属性获取按键代码，但少部分浏览器使用的却是charCode)
        if (code === 13) {
            search_click();
        }
    }

    // 搜索按钮点击事件
    function search_click() {
        // 取搜索框中值
        map.clearOverlays();
        keyword = $("input#keyword").val();
        index = 0;
        bdGEO();
    }

    // 关键字匹配
    function bdGEO() {
        var add = adds[index];
        var repair = repairs[index];
        //字符串方法indexOf
        if (keyword !== ""){
            if (add.indexOf(keyword) >= 0) {    // 如果关键字匹配得上，添加到地图上
                geocodeSearch(add, repair);
                count++;
            }
        }else{  // 如果未输入，则显示全部修理厂
            count = 0;
            map.centerAndZoom(new BMap.Point(116.797107,37.636986), 5);
            var info = add + '<br/>' + repair;
            myGeo.getPoint(info, function (point) {
                if (point) {
                    var address = new BMap.Point(point.lng, point.lat);
                    addMarker(address, info);
                }
            }, "北京市");
        }
        index++;
        if (index < adds.length){
            bdGEO();
        }else if (count === 0){
            alert("无查询结果。")
        }
    }

    function geocodeSearch(add, repair) {
        // 显示地址和修理厂名称
        var info = add + '<br/>' + repair;

        // 目标地址中心化，并获取其经纬度
        myGeo.getPoint(info, function (point) {
            if (point) {
                map.centerAndZoom(point, 7);
                var address = new BMap.Point(point.lng, point.lat);
                addMarker(address, info);
            }
        }, "北京市");
    }


    // 编写自定义函数,创建标注
    function addMarker(point, info) {

        //创建检索信息窗口对象
        var searchInfoWindow = null;
        searchInfoWindow = new BMapLib.SearchInfoWindow(map, info, {
            title: "车辆定损网点",      //标题
            width: 290,             //宽度
            height: 50,              //高度
            panel: "panel",         //检索结果面板
            enableAutoPan: true,     //自动平移
            searchTypes: [
                BMAPLIB_TAB_TO_HERE,  //到这里去
                BMAPLIB_TAB_FROM_HERE //从这里出发
            ]
        });

        var marker = new BMap.Marker(point); //创建marker对象
        marker.addEventListener("click", function (e) {
            searchInfoWindow.open(marker);
        })
        map.addOverlay(marker); //在地图中添加marker
    }

</script>
